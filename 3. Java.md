# Buat Producer Menggunakan Java

1. Install Java Development Kit di server CentOS.

```
sudo yum install java-1.8.0-openjdk-devel
```

2. Buat file `NotifProducer.java` yang isinya:

```
import org.apache.kafka.clients.producer.*;

import java.util.Properties;

public class SimpleProducer {
    public static void main(String[] args) {
        String topicName = "notifications";
        String key = "taylor_shift";
        String value = "New message from john_wok";

        Properties props = new Properties();
        props.put("bootstrap.servers", "localhost:9092");
        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

        Producer<String, String> producer = new KafkaProducer<>(props);

        ProducerRecord<String, String> record = new ProducerRecord<>(topicName, key, value);

        producer.send(record, (metadata, exception) -> {
            if (metadata != null) {
                System.out.println("Message sent successfully, offset: " + metadata.offset());
            } else {
                System.err.println("Error sending message: " + exception.getMessage());
            }
        });

        producer.close();
    }
}
```

3. Compile code java menggunakan command `javac` dan lokasi library Kafka berada. 

```
javac -cp "/home/coba/kafka/libs/*" NotifProducer.java
```

4. Run Kafka Producer

```
java -cp "/home/coba/kafka/libs/*:." NotifProducer
```
