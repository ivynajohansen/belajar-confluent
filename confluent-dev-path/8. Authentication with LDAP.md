# Apache KafkaÂ® Client Authentication with LDAP

## LDAP Terminology

- Principal: A user, group, application, or service

- **dc:** "Domain Component"

  ex: dc=confluent,dc=io

  ex: dc=google,dc=com

- **ou:** "Organizational Unit"

  ex: ou=groups

- **cn:** "Common Name"

  ex: cn=devs

- **dn:** "Distinguished Name"

  ex: dn:cn=devs,ou=groups,dc=confluent,dc=io

## Konfigurasi Confluent Server LdapAuthenticateCallbackHandler

![image](https://github.com/user-attachments/assets/3b874a4e-803f-4dfb-8266-31d24488b855)

Bagian utama dari diagram menunjukkan proses autentikasi klien Kafka melalui LDAP. Sementara itu, sisa diagram dengan penekanan yang berkurang menggambarkan proses autentikasi dan otorisasi Kafka yang lengkap melalui Kontrol Akses Berbasis Peran (RBAC) dari Confluent Platform.

Ada dua persyaratan utama untuk mengaktifkan autentikasi klien LDAP:

1. Konfigurasi SASL untuk mengautentikasi pengguna/prinsip menggunakan LDAP

- Pengaturan koneksi layanan direktori LDAP adalah sebagai berikut:

```
ldap.java.naming.provider.url=ldaps://directory-service:10636
# Authenticate to LDAP
ldap.java.naming.security.principal=uid=admin,ou=system
ldap.java.naming.security.credentials=secret
ldap.java.naming.security.authentication=simple
```

- Pengaturan pencarian pengguna

```
# Locate users
ldap.user.search.base=ou=users,dc=confluent,dc=io
ldap.user.name.attribute=uid
ldap.user.object.class=inetOrgPerson
```

2. Konfigurasi broker listener yang akan digunakan LdapAuthenticateCallbackHandler

```
listener.name.client.sasl.enabled.mechanisms=PLAIN
listener.name.client.plain.sasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule diperlukan;
listener.name.client.plain.sasl.server.callback.handler.class=io.confluent.security.auth.provider.ldap.LdapAuthenticateCallbackHandler
```

Jika menggunakan RBAC di Confluent Platform untuk mengotorisasi akses berdasarkan keanggotaan grup di layanan direktori LDAP, maka pengaturan pencarian grup perlu dikonfigurasi.

```
ldap.search.mode=GROUPS
ldap.group.search.base=ou=groups,dc=confluent,dc=io
ldap.group.object.class=groupOfNames
ldap.group.name.attribute=cn
ldap.group.member.attribute=member
ldap.group.member.attribute.pattern=cn=(.*),ou=users,dc=confluent,dc=io
```

## Konfigurasi Autentikasi Kafka Client SASL PLAIN

Untuk mengonfigurasi klien Kafka supaya autentikasi SASL PLAIN dengan, tambahkan pengaturan yang diperlukan ke konfigurasinya:

| Parameter                     | Deskripsi                                                                                                                                                      |
|-------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| sasl.mechanism                | PLAIN adalah mekanisme otentikasi sederhana menggunakan nama pengguna/kata sandi. Nama pengguna digunakan sebagai prinsipal yang terautentikasi untuk otorisasi. |
| sasl.jaas.config              | Parameter konteks login JAAS. Format nilai adalah: loginModuleClass controlFlag (optionName=optionValue)*;                                                  |
| security.protocol             | Protokol yang digunakan untuk berkomunikasi dengan broker. SASL_SSL disarankan agar ID pengguna dan kata sandi terenkripsi saat ditransmisikan.                |
| ssl.truststore.location       | Lokasi file trust store.                                                                                                                                   |
| ssl.truststore.password       | Kata sandi untuk file trust store.                                                                                                                           |
